{"ast":null,"code":"class Event {\n  constructor(type, payload) {\n    this.type = void 0;\n    this.payload = void 0;\n    this.type = type;\n    this.payload = payload;\n  }\n}\nexport const connectWS = conn => {\n  const socket = new WebSocket('ws://localhost:8080/ws');\n  console.log('Attempting Websocket Connection');\n  socket.onopen = () => {\n    console.log('Successfully Connected');\n  };\n  socket.onclose = event => {\n    console.log('socket Closed Connection: ', event);\n  };\n  socket.onmessage = e => {\n    const eventData = JSON.parse(e.data);\n    routeEvent(eventData);\n  };\n  socket.onerror = error => {\n    console.log('socket Error: ', error);\n  };\n  conn.current = socket;\n  return () => {\n    if (conn.current && conn.current.readyState === WebSocket.OPEN) {\n      conn.current.close();\n    }\n    conn.current = null; // Reset the WebSocket reference when closed\n  };\n};\n\nfunction routeEvent(data) {\n  if (data.type === undefined) {\n    alert('no such event type');\n  }\n  switch (data.type) {\n    case 'New_Message':\n      socket.send(data);\n      break;\n    case 'New_Notification':\n      socket.send(data);\n      break;\n    default:\n      alert('Unsupported event');\n  }\n}\nexport function sendEvent(name, data) {\n  const event = new Event(name, data);\n  socket.send(JSON.stringify(event));\n}","map":{"version":3,"names":["Event","constructor","type","payload","connectWS","conn","socket","WebSocket","console","log","onopen","onclose","event","onmessage","e","eventData","JSON","parse","data","routeEvent","onerror","error","current","readyState","OPEN","close","undefined","alert","send","sendEvent","name","stringify"],"sources":["/Users/alekspavlov/Desktop/Kood-Johvi/social-network/src/api/wsRouter.ts"],"sourcesContent":["class Event {\n    type: string\n    payload: any\n    constructor(type: string, payload: any) {\n        this.type = type\n        this.payload = payload\n    }\n}\n\nexport const connectWS = (conn: React.MutableRefObject<WebSocket | null>) => {\n    const socket = new WebSocket('ws://localhost:8080/ws')\n    console.log('Attempting Websocket Connection')\n\n    socket.onopen = () => {\n        console.log('Successfully Connected')\n    }\n\n    socket.onclose = (event) => {\n        console.log('socket Closed Connection: ', event)\n    }\n\n    socket.onmessage = (e) => {\n        const eventData = JSON.parse(e.data)\n        routeEvent(eventData)\n    }\n\n    socket.onerror = (error) => {\n        console.log('socket Error: ', error)\n    }\n    conn.current = socket\n    return () => {\n        if (conn.current && conn.current.readyState === WebSocket.OPEN) {\n            conn.current.close();\n        }\n        conn.current = null; // Reset the WebSocket reference when closed\n    };\n}\n\nfunction routeEvent(data: any): any {\n    if (data.type === undefined) {\n        alert('no such event type')\n    }\n    switch (data.type) {\n        case 'New_Message':\n            socket.send(data)\n            break\n        case 'New_Notification':\n            socket.send(data)\n            break\n        default:\n            alert('Unsupported event')\n    }\n}\n\nexport function sendEvent(name: string, data: any) {\n    const event = new Event(name, data)\n    socket.send(JSON.stringify(event))\n}\n"],"mappings":"AAAA,MAAMA,KAAK,CAAC;EAGRC,WAAWA,CAACC,IAAY,EAAEC,OAAY,EAAE;IAAA,KAFxCD,IAAI;IAAA,KACJC,OAAO;IAEH,IAAI,CAACD,IAAI,GAAGA,IAAI;IAChB,IAAI,CAACC,OAAO,GAAGA,OAAO;EAC1B;AACJ;AAEA,OAAO,MAAMC,SAAS,GAAIC,IAA8C,IAAK;EACzE,MAAMC,MAAM,GAAG,IAAIC,SAAS,CAAC,wBAAwB,CAAC;EACtDC,OAAO,CAACC,GAAG,CAAC,iCAAiC,CAAC;EAE9CH,MAAM,CAACI,MAAM,GAAG,MAAM;IAClBF,OAAO,CAACC,GAAG,CAAC,wBAAwB,CAAC;EACzC,CAAC;EAEDH,MAAM,CAACK,OAAO,GAAIC,KAAK,IAAK;IACxBJ,OAAO,CAACC,GAAG,CAAC,4BAA4B,EAAEG,KAAK,CAAC;EACpD,CAAC;EAEDN,MAAM,CAACO,SAAS,GAAIC,CAAC,IAAK;IACtB,MAAMC,SAAS,GAAGC,IAAI,CAACC,KAAK,CAACH,CAAC,CAACI,IAAI,CAAC;IACpCC,UAAU,CAACJ,SAAS,CAAC;EACzB,CAAC;EAEDT,MAAM,CAACc,OAAO,GAAIC,KAAK,IAAK;IACxBb,OAAO,CAACC,GAAG,CAAC,gBAAgB,EAAEY,KAAK,CAAC;EACxC,CAAC;EACDhB,IAAI,CAACiB,OAAO,GAAGhB,MAAM;EACrB,OAAO,MAAM;IACT,IAAID,IAAI,CAACiB,OAAO,IAAIjB,IAAI,CAACiB,OAAO,CAACC,UAAU,KAAKhB,SAAS,CAACiB,IAAI,EAAE;MAC5DnB,IAAI,CAACiB,OAAO,CAACG,KAAK,CAAC,CAAC;IACxB;IACApB,IAAI,CAACiB,OAAO,GAAG,IAAI,CAAC,CAAC;EACzB,CAAC;AACL,CAAC;;AAED,SAASH,UAAUA,CAACD,IAAS,EAAO;EAChC,IAAIA,IAAI,CAAChB,IAAI,KAAKwB,SAAS,EAAE;IACzBC,KAAK,CAAC,oBAAoB,CAAC;EAC/B;EACA,QAAQT,IAAI,CAAChB,IAAI;IACb,KAAK,aAAa;MACdI,MAAM,CAACsB,IAAI,CAACV,IAAI,CAAC;MACjB;IACJ,KAAK,kBAAkB;MACnBZ,MAAM,CAACsB,IAAI,CAACV,IAAI,CAAC;MACjB;IACJ;MACIS,KAAK,CAAC,mBAAmB,CAAC;EAClC;AACJ;AAEA,OAAO,SAASE,SAASA,CAACC,IAAY,EAAEZ,IAAS,EAAE;EAC/C,MAAMN,KAAK,GAAG,IAAIZ,KAAK,CAAC8B,IAAI,EAAEZ,IAAI,CAAC;EACnCZ,MAAM,CAACsB,IAAI,CAACZ,IAAI,CAACe,SAAS,CAACnB,KAAK,CAAC,CAAC;AACtC"},"metadata":{},"sourceType":"module","externalDependencies":[]}